"use strict";var e=require("./register-394922e2.js"),r=require("path"),t=require("webpack"),s=require("webpack-merge"),n=require("mini-css-extract-plugin"),o=require("optimize-css-assets-webpack-plugin"),a=require("terser-webpack-plugin"),i=require("fs-extra"),l=require("slash");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=u(r),d=u(t),f=u(n),p=u(o),m=u(a),b=u(i),g=u(l),j=function(r){var t=e.getIteratorMethod(r);if("function"!=typeof t)throw TypeError(String(r)+" is not iterable");return e.anObject(t.call(r))},x=e.createCommonjsModule((function(r){r.exports=function(r,t){if(void 0!==e.symbol&&e.isIterable(Object(r))){var s=[],n=!0,o=!1,a=void 0;try{for(var i,l=j(r);!(n=(i=l.next()).done)&&(s.push(i.value),!t||s.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return s}},r.exports.default=r.exports,r.exports.__esModule=!0})),y=e.createCommonjsModule((function(r){r.exports=function(r,t){return e.arrayWithHoles(r)||x(r,t)||e.unsupportedIterableToArray(r,t)||e.nonIterableRest()},r.exports.default=r.exports,r.exports.__esModule=!0})),_=e.unwrapExports(y),v=e.promise,w=process.cwd(),h={performance:{hints:"warning"},output:{pathinfo:!1},optimization:{nodeEnv:"production",namedModules:!1,namedChunks:!1,flagIncludedChunks:!0,occurrenceOrder:!0,sideEffects:!0,usedExports:!0,concatenateModules:!1,splitChunks:{minSize:3e4,maxAsyncRequests:5,maxInitialRequests:3},minimize:!0,minimizer:[new p.default,new m.default]},plugins:[new d.default.DefinePlugin({"process.env.NODE_ENV":e.stringify("production")})]},k=process.cwd(),C="."+e.getEngine(),q=function(){var r=e._asyncToGenerator(e.regenerator.mark((function r(t){var s,n,o,a,i,l,u,d,f,p,m,j,x;return e.regenerator.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s={},r.next=3,e.getPages();case 3:for(n=r.sent,o=c.default.resolve(__dirname,"../../lib/webpack/".concat(e.ssrConfig.id,".js")),a=b.default.readFileSync(o).toString(),i=c.default.join(__dirname,"app.js"),b.default.existsSync(c.default.join(k,e.ssrConfig.viewsDir,"_app".concat(C)))&&(i=c.default.join(k,e.ssrConfig.viewsDir,"_app".concat(C))),t.mkdirpSync(c.default.join(k,"react-ssr-src")),l=0;l<n.length;l++)p=n[l],m=e.getPageId(p,"/"),j=c.default.dirname(m),x=c.default.basename(m),"."!==j&&t.mkdirpSync(c.default.join(k,"react-ssr-src",j)),t.writeFileSync(c.default.join(k,"react-ssr-src",j,e.concat(u="entry-".concat(x)).call(u,C)),a.replace("__REACT_SSR_APP__",g.default(i)).replace("__REACT_SSR_PAGE__",g.default(p))),s[e.getPageId(p,"_")]=e.concat(d=e.concat(f="./react-ssr-src/".concat(g.default(j),"/entry-")).call(f,x)).call(d,C);return r.abrupt("return",[s,n]);case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();exports._slicedToArray=_,exports.configureWebpack=function(r){var t={mode:"development",devtool:!e.isProd()&&"eval-source-map",entry:r,output:{path:c.default.join(w,e.ssrConfig.distDir),filename:"[name].js"},resolve:{extensions:[".js",".jsx",".ts",".tsx"]},module:{rules:[{test:/\.(js|ts)x?$/i,exclude:/node_modules/,use:{loader:require.resolve("babel-loader"),options:{cacheDirectory:!0,extends:e.existsSync(c.default.join(w,".babelrc"))?c.default.join(w,".babelrc"):e.existsSync(c.default.join(w,".babelrc.js"))?c.default.join(w,".babelrc.js"):e.existsSync(c.default.join(w,"babel.config.js"))?c.default.join(w,"babel.config.js"):c.default.join(__dirname,"../../lib/babel.js")}}},{test:/\.css$/i,use:[{loader:f.default.loader,options:{publicPath:c.default.join(w,e.ssrConfig.distDir),hmr:!e.isProd(),reloadAll:!0}},{loader:require.resolve("css-loader")}]},{test:/\.scss$/i,use:[{loader:f.default.loader,options:{publicPath:c.default.join(w,e.ssrConfig.distDir),hmr:!e.isProd(),reloadAll:!0}},{loader:require.resolve("css-loader")},{loader:require.resolve("sass-loader"),options:{sourceMap:!e.isProd()}}]}]},plugins:[new f.default({filename:"[name].css",chunkFilename:"[id].css",ignoreOrder:!0})]};return e.isProd()&&(t=s.smart(t,h)),e.ssrConfig.webpack&&("function"==typeof e.ssrConfig.webpack?t=e.ssrConfig.webpack(t,e.isProd()?"production":"development"):console.warn("[ warn ] ssr.config.js#webpack must be a function")),t},exports.getEntry=q,exports.promise=v;
